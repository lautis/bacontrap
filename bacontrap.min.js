/* Bacontrap v0.3.3. Copyright 2013 Ville Lautanala. https://raw.githubusercontent.com/lautis/bacontrap/master/LICENSE.txt */var Bacon,Bacontrap,curry2,i,matchKey,matchKeys,matchModifiers,modifierPressed,stringify,__indexOf=[].indexOf||function(t){for(var r=0,n=this.length;r<n;r++)if(r in this&&this[r]===t)return r;return-1};Bacon=require("baconjs"),stringify=function(t){var r;return r=t.keyCode,Bacontrap.map[r]||t.key||String.fromCharCode(r).toLowerCase()},curry2=function(t,r){return function(n){return t(r,n)}},Bacontrap={input:Bacon.fromEventTarget(document,"keydown"),defaults:{timeout:1500,global:!1},aliases:{cmd:"meta",command:"meta",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl",option:"alt"},map:{8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},groups:{num:function(){var t,r;for(r=[],i=t=0;t<=9;i=++t)r.push(i.toString());return r}()},modifiers:["shift","alt","meta","ctrl"]},matchModifiers=function(t,r){var n,a,e,o;for(o=Bacontrap.modifiers,a=0,e=o.length;a<e;a++)if(n=o[a],modifierPressed(n,r)!==__indexOf.call(t,n)>=0)return!1;return!0},modifierPressed=function(t,r){var n,a,e;return e=r[t+"Key"]||stringify(r)===t,"keydown"===r.type&&"shift"===t?(a=stringify(r),n=a.toLowerCase()!==a.toUpperCase(),n&&e):e},matchKey=function(t,r){return Bacontrap.groups[t]?Bacontrap.groups[t].indexOf(stringify(r))>=0:stringify(r)===t},matchKeys=function(t,r){var n,a,e;for(a=0,e=t.length;a<e;a++)if(n=t[a],__indexOf.call(Bacontrap.modifiers,n)<0&&!matchKey(n,r))return!1;return!0},Bacontrap.match=function(t,r){return matchKeys(t,r)&&matchModifiers(t,r)},Bacontrap.notInput=function(t){var r,n;return r=t.target||t.srcElement||{},n=r.tagName,!("INPUT"===n||"SELECT"===n||"TEXTAREA"===n||r.isContentEditable)},Bacontrap.trap=function(t,r,n,a){var e,o;return null==n&&(n=Bacontrap.defaults.timeout),null==a&&(a=[]),e=r[a.length],o=0===a.length?t:t.take(1).takeUntil(Bacon.later(n,!0)),o.filter(curry2(Bacontrap.match,e)).flatMap(function(e){return a.length+1===r.length?Bacon.once(e):Bacontrap.trap(t,r,n,a.concat(e))})},Bacontrap.parse=function(t){var r,n,a,e,o,i,c,u,s,f,p;for(n=function(t){var r;return(r=Bacontrap.aliases[t])?[r]:1===t.length&&t.toLowerCase()!==t?["shift",t.toLowerCase()]:[t]},s=t.split(" "),p=[],o=0,c=s.length;o<c;o++){for(e=s[o],r=[],f=e.split("+"),i=0,u=f.length;i<u;i++)a=f[i],r.push.apply(r,n(a));p.push(r)}return p},Bacontrap.bind=function(t,r){var n,a,e,o;return null==r&&(r={}),n=r.global||Bacontrap.defaults.global?Bacontrap.input:Bacontrap.input.filter(Bacontrap.notInput),o=function(){var o,i,c,u;for(c=[].concat(t),u=[],o=0,i=c.length;o<i;o++)e=c[o],a=Bacontrap.parse(e),u.push(Bacontrap.trap(n,a,r.timeout));return u}(),Bacon.mergeAll(o)},module.exports=Bacontrap;